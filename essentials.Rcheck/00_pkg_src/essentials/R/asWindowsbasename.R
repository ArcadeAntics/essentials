asWindowsbasename <- function (path)
{
    path <- gsub("^ +|( |\\.)+$", "", chartr("\001\002\003\004\005\006\007\010\011\012\013\014\015\016\017\020\021\022\023\024\025\026\027\027\030\031\032\033\034\035\036\037\"*/:<>?\\|", "_________________________________________", path))
    path[!nzchar(path)] <- "_"
    path
}
